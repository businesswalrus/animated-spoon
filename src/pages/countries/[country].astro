---
import MainLayout from '../../layouts/MainLayout.astro';
import PageHeroOptimized from '../../components/PageHeroOptimized.astro';
import Breadcrumbs from '../../components/Breadcrumbs.astro';
import StatsCounter from '../../components/StatsCounter.astro';
import TestimonialCard from '../../components/TestimonialCard.astro';
import ContactForm from '../../components/ContactForm.astro';
import { getAllCountries, getCountryData } from '../../data/countries';

// Enable prerendering for static generation of all country pages
export const prerender = true;

export async function getStaticPaths() {
  const countries = getAllCountries();
  return countries.map((country) => ({
    params: { country: country.slug },
    props: { countryData: country },
  }));
}

const { countryData } = Astro.props;

const pageTitle = `AARBAA ${countryData.name} - International Chapter`;
const pageDescription = `Join AARBAA's international chapter in ${countryData.name}. ${countryData.stats.members} members across ${countryData.stats.chapters} chapters advocating for balanced road safety policy and motorists' rights.`;
const pageUrl = `https://aarbaa.com/countries/${countryData.slug}`;
const pageImage = 'https://aarbaa.com/images/protest.webp';

// Breadcrumb navigation data
const breadcrumbs = [
  { name: 'Home', url: '/' },
  { name: 'International', url: '/countries' },
  { name: countryData.name, url: pageUrl }
];

// Helper function to get approximate geo coordinates for country capitals
const getCapitalCoordinates = (countrySlug: string) => {
  const coords: Record<string, { lat: number; lng: number }> = {
    'united-kingdom': { lat: 51.5074, lng: -0.1278 }, // London
    'canada': { lat: 45.4215, lng: -75.6972 }, // Ottawa
    'australia': { lat: -35.2809, lng: 149.1300 }, // Canberra
    'netherlands': { lat: 52.3676, lng: 4.9041 }, // Amsterdam
    'germany': { lat: 52.5200, lng: 13.4050 }, // Berlin
  };
  return coords[countrySlug] || { lat: 0, lng: 0 };
};

const coords = getCapitalCoordinates(countryData.slug);

// Build comprehensive structured data
const structuredDataGraph = [];

// Enhanced Organization Schema with AggregateRating
const organizationSchema: any = {
  "@type": "Organization",
  "@id": `${pageUrl}#organization`,
  "name": `AARBAA ${countryData.name}`,
  "url": pageUrl,
  "description": pageDescription,
  "logo": "https://aarbaa.com/images/aarbaa-new-logo (2).svg",
  "image": pageImage,
  "address": {
    "@type": "PostalAddress",
    "streetAddress": countryData.regionalDirector ? "Contact for address" : "",
    "addressLocality": countryData.capital,
    "addressCountry": countryData.code
  },
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": coords.lat,
    "longitude": coords.lng
  },
  "contactPoint": {
    "@type": "ContactPoint",
    "telephone": countryData.regionalDirector.phone,
    "email": countryData.regionalDirector.email,
    "contactType": "Regional Director",
    "areaServed": countryData.code,
    "availableLanguage": countryData.language
  },
  "parentOrganization": {
    "@type": "Organization",
    "name": "Americans Against Road Bikers Association of America",
    "url": "https://aarbaa.com"
  },
  "numberOfEmployees": {
    "@type": "QuantitativeValue",
    "value": countryData.stats.chapters
  },
  "memberOf": {
    "@type": "Organization",
    "name": "AARBAA International"
  },
  "sameAs": [
    `https://twitter.com/aarbaa_${countryData.slug}`,
    `https://facebook.com/aarbaa.${countryData.slug}`,
    `https://linkedin.com/company/aarbaa-${countryData.slug}`
  ],
  "areaServed": {
    "@type": "Country",
    "name": countryData.name
  }
};

// Add AggregateRating if rating data exists
if (countryData.rating) {
  organizationSchema.aggregateRating = {
    "@type": "AggregateRating",
    "ratingValue": countryData.rating.average,
    "reviewCount": countryData.rating.count,
    "bestRating": 5,
    "worstRating": 1
  };
}

structuredDataGraph.push(organizationSchema);

// Person Schema for Regional Director
if (countryData.regionalDirector) {
  structuredDataGraph.push({
    "@type": "Person",
    "@id": `${pageUrl}#director`,
    "name": countryData.regionalDirector.name,
    "jobTitle": countryData.regionalDirector.title,
    "email": countryData.regionalDirector.email,
    "telephone": countryData.regionalDirector.phone,
    "worksFor": {
      "@id": `${pageUrl}#organization`
    },
    "address": {
      "@type": "PostalAddress",
      "addressLocality": countryData.capital,
      "addressCountry": countryData.code
    }
  });
}

// Event Schema for Upcoming Events
if (countryData.upcomingEvents && countryData.upcomingEvents.length > 0) {
  countryData.upcomingEvents.forEach((event, index) => {
    structuredDataGraph.push({
      "@type": "Event",
      "@id": `${pageUrl}#event-${index}`,
      "name": event.name,
      "description": event.description,
      "startDate": event.date + "T" + "09:00:00",
      "endDate": (event.endDate || event.date) + "T20:30:00",
      "eventAttendanceMode": "https://schema.org/OfflineEventAttendanceMode",
      "eventStatus": "https://schema.org/EventScheduled",
      "location": {
        "@type": "Place",
        "name": event.venue,
        "address": {
          "@type": "PostalAddress",
          "streetAddress": event.address,
          "addressLocality": event.city,
          "addressCountry": countryData.code
        }
      },
      "organizer": {
        "@id": `${pageUrl}#organization`
      },
      "isAccessibleForFree": !event.registrationRequired,
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": countryData.currency,
        "availability": "https://schema.org/InStock",
        "validFrom": new Date().toISOString()
      },
      "image": pageImage,
      "performer": {
        "@id": `${pageUrl}#director`
      }
    });
  });
}

// FAQPage Schema
if (countryData.faqs && countryData.faqs.length > 0) {
  structuredDataGraph.push({
    "@type": "FAQPage",
    "@id": `${pageUrl}#faq`,
    "mainEntity": countryData.faqs.map(faq => ({
      "@type": "Question",
      "name": faq.question,
      "acceptedAnswer": {
        "@type": "Answer",
        "text": faq.answer
      }
    }))
  });
}

// Article Schema for Featured Article
if (countryData.featuredArticle) {
  structuredDataGraph.push({
    "@type": "Article",
    "@id": `${pageUrl}#featured-article`,
    "headline": countryData.featuredArticle.title,
    "description": countryData.featuredArticle.excerpt,
    "url": countryData.featuredArticle.link,
    "datePublished": new Date().toISOString(),
    "dateModified": new Date().toISOString(),
    "author": {
      "@id": `${pageUrl}#organization`
    },
    "publisher": {
      "@id": `${pageUrl}#organization`
    },
    "image": pageImage,
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": pageUrl
    }
  });
}

// ImageGallery Schema
if (countryData.photoGallery && countryData.photoGallery.length > 0) {
  countryData.photoGallery.forEach((photo, index) => {
    structuredDataGraph.push({
      "@type": "ImageObject",
      "@id": `${pageUrl}#image-${index}`,
      "contentUrl": `https://aarbaa.com${photo.url}`,
      "name": photo.title,
      "caption": photo.caption,
      "description": photo.alt,
      "uploadDate": new Date().toISOString(),
      "copyrightHolder": {
        "@id": `${pageUrl}#organization`
      }
    });
  });
}

// BreadcrumbList Schema
structuredDataGraph.push({
  "@type": "BreadcrumbList",
  "@id": `${pageUrl}#breadcrumb`,
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://aarbaa.com"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "International",
      "item": "https://aarbaa.com/countries"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": countryData.name,
      "item": pageUrl
    }
  ]
});

// WebPage Schema to tie everything together
structuredDataGraph.push({
  "@type": "WebPage",
  "@id": pageUrl,
  "url": pageUrl,
  "name": pageTitle,
  "description": pageDescription,
  "isPartOf": {
    "@type": "WebSite",
    "name": "AARBAA",
    "url": "https://aarbaa.com"
  },
  "about": {
    "@id": `${pageUrl}#organization`
  },
  "breadcrumb": {
    "@id": `${pageUrl}#breadcrumb`
  },
  "image": pageImage,
  "primaryImageOfPage": {
    "@type": "ImageObject",
    "contentUrl": pageImage
  }
});

// Final JSON-LD structure
const structuredData = {
  "@context": "https://schema.org",
  "@graph": structuredDataGraph
};

// Helper function to format currency
const formatCurrency = (amount: number, currency: string) => {
  const symbols: Record<string, string> = {
    'USD': '$',
    'GBP': '£',
    'CAD': 'CA$',
    'AUD': 'AU$',
    'EUR': '€'
  };
  return `${symbols[currency] || currency} ${(amount / 1000000).toFixed(1)}M`;
};

// Helper function to format date range
const formatDateRange = (date: string, endDate?: string) => {
  const start = new Date(date);
  const options: Intl.DateTimeFormatOptions = { month: 'short', day: 'numeric', year: 'numeric' };

  if (endDate) {
    const end = new Date(endDate);
    if (start.getMonth() === end.getMonth()) {
      return `${start.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} - ${end.getDate()}, ${start.getFullYear()}`;
    }
    return `${start.toLocaleDateString('en-US', options)} - ${end.toLocaleDateString('en-US', options)}`;
  }

  return start.toLocaleDateString('en-US', options);
};

// Helper function to get event type badge class
const getEventTypeBadge = (type: string) => {
  const badges: Record<string, string> = {
    'meeting': 'bg-primary',
    'rally': 'bg-danger',
    'presentation': 'bg-info',
    'community': 'bg-success',
    'conference': 'bg-warning text-dark'
  };
  return badges[type] || 'bg-secondary';
};

// Helper function to get category badge
const getCategoryBadge = (category: string) => {
  const badges: Record<string, string> = {
    'infrastructure': 'bg-primary',
    'legislation': 'bg-success',
    'funding': 'bg-warning text-dark',
    'awareness': 'bg-info'
  };
  return badges[category] || 'bg-secondary';
};

// Helper function to get severity badge
const getSeverityBadge = (severity: string) => {
  const badges: Record<string, string> = {
    'critical': 'bg-danger',
    'high': 'bg-warning text-dark',
    'medium': 'bg-info'
  };
  return badges[severity] || 'bg-secondary';
};

// Helper function to get status badge
const getStatusBadge = (status: string) => {
  const badges: Record<string, string> = {
    'identified': 'bg-secondary',
    'advocating': 'bg-primary',
    'approved': 'bg-success',
    'in-progress': 'bg-info',
    'resolved': 'bg-success'
  };
  return badges[status] || 'bg-secondary';
};
---

<MainLayout
  title={pageTitle}
  description={pageDescription}
  ogImage={pageImage}
>
  <!-- Enhanced SEO meta tags -->
  <meta slot="head" name="keywords" content={`AARBAA ${countryData.name}, road safety ${countryData.name}, cycling infrastructure ${countryData.name}, motorists rights ${countryData.name}, traffic advocacy`} />
  <meta slot="head" name="author" content={`AARBAA ${countryData.name}`} />
  <link slot="head" rel="canonical" href={pageUrl} />

  <!-- Geo tags for location targeting -->
  <meta slot="head" name="geo.region" content={countryData.code} />
  <meta slot="head" name="geo.placename" content={countryData.capital} />
  <meta slot="head" name="geo.position" content={`${coords.lat};${coords.lng}`} />
  <meta slot="head" name="ICBM" content={`${coords.lat}, ${coords.lng}`} />

  <!-- Language tags -->
  <meta slot="head" http-equiv="content-language" content={countryData.language.split('/')[0]} />

  <!-- Structured Data -->
  <script slot="head" type="application/ld+json" set:html={JSON.stringify(structuredData)} />

  <!-- Hero Section -->
  <PageHeroOptimized
    title={`AARBAA ${countryData.name}`}
    subtitle={`International Chapter - ${countryData.capital}`}
  />

  <!-- Breadcrumbs -->
  <div class="container my-4">
    <Breadcrumbs items={breadcrumbs} />
  </div>

  <!-- Main Content -->
  <div class="container my-5">
    <!-- Impact Stats -->
    <section class="mb-5">
      <div class="row g-4">
        <div class="col-md-3 col-6">
          <div class="stat-card text-center p-4 h-100 border rounded shadow-sm bg-light">
            <div class="display-4 fw-bold text-primary">
              <StatsCounter end={countryData.stats.members} />
            </div>
            <div class="text-muted mt-2">Active Members</div>
          </div>
        </div>
        <div class="col-md-3 col-6">
          <div class="stat-card text-center p-4 h-100 border rounded shadow-sm bg-light">
            <div class="display-4 fw-bold text-success">
              <StatsCounter end={countryData.stats.chapters} />
            </div>
            <div class="text-muted mt-2">Local Chapters</div>
          </div>
        </div>
        <div class="col-md-3 col-6">
          <div class="stat-card text-center p-4 h-100 border rounded shadow-sm bg-light">
            <div class="display-4 fw-bold text-warning">
              <StatsCounter end={countryData.stats.victories} />
            </div>
            <div class="text-muted mt-2">Victories</div>
          </div>
        </div>
        <div class="col-md-3 col-6">
          <div class="stat-card text-center p-4 h-100 border rounded shadow-sm bg-light">
            <div class="display-4 fw-bold text-info">{countryData.code}</div>
            <div class="text-muted mt-2">Country Code</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Regional Director Leadership Card -->
    {countryData.regionalDirector && (
      <section class="mb-5">
        <h2 class="mb-4">Regional Leadership</h2>
        <div class="card shadow-sm">
          <div class="card-body">
            <div class="row align-items-center">
              <div class="col-md-8">
                <h3 class="card-title h4">{countryData.regionalDirector.name}</h3>
                <p class="text-muted mb-3">{countryData.regionalDirector.title}</p>
                <p class="mb-0">
                  Leading AARBAA's advocacy efforts across {countryData.name}, coordinating {countryData.stats.chapters} regional chapters and representing the interests of {countryData.stats.members.toLocaleString()} members.
                </p>
              </div>
              <div class="col-md-4 mt-3 mt-md-0">
                <div class="d-grid gap-2">
                  <a href={`mailto:${countryData.regionalDirector.email}`} class="btn btn-primary">
                    <i class="bi bi-envelope me-2"></i>Email
                  </a>
                  <a href={`tel:${countryData.regionalDirector.phone}`} class="btn btn-outline-primary">
                    <i class="bi bi-telephone me-2"></i>{countryData.regionalDirector.phone}
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    )}

    <!-- Rating Display -->
    {countryData.rating && (
      <section class="mb-5">
        <div class="card shadow-sm border-warning">
          <div class="card-body text-center">
            <h3 class="h5 mb-3">Member Rating</h3>
            <div class="mb-2">
              {Array.from({ length: 5 }).map((_, i) => (
                <i class={`bi bi-star${i < Math.round(countryData.rating.average) ? '-fill' : ''} text-warning fs-4`}></i>
              ))}
            </div>
            <div class="text-muted">
              {countryData.rating.average.toFixed(1)} out of 5 based on {countryData.rating.count.toLocaleString()} reviews
            </div>
          </div>
        </div>
      </section>
    )}

    <!-- Testimonials Section -->
    {countryData.testimonials && countryData.testimonials.length > 0 && (
      <section class="mb-5">
        <h2 class="mb-4">Voices from {countryData.name}</h2>
        <div class="row g-4">
          {countryData.testimonials.map((testimonial, index) => (
            <div class="col-md-4">
              <TestimonialCard
                quote={testimonial.quote}
                author={testimonial.author}
                location={testimonial.city}
                variant={index % 3 === 0 ? 'primary' : index % 3 === 1 ? 'success' : 'warning'}
              />
            </div>
          ))}
        </div>
      </section>
    )}

    <!-- Featured Article -->
    {countryData.featuredArticle && (
      <section class="mb-5">
        <h2 class="mb-4">Latest from {countryData.name}</h2>
        <div class="card shadow-sm border-primary">
          <div class="card-body">
            <span class="badge bg-primary mb-2">Featured Story</span>
            <h3 class="card-title h4">{countryData.featuredArticle.title}</h3>
            <p class="card-text">{countryData.featuredArticle.excerpt}</p>
            <a href={countryData.featuredArticle.link} class="btn btn-primary">
              Read Full Article <i class="bi bi-arrow-right ms-2"></i>
            </a>
          </div>
        </div>
      </section>
    )}

    <!-- FAQs Section -->
    {countryData.faqs && countryData.faqs.length > 0 && (
      <section class="mb-5">
        <h2 class="mb-4">Frequently Asked Questions</h2>
        <div class="accordion" id="faqAccordion">
          {countryData.faqs.map((faq, index) => (
            <div class="accordion-item">
              <h3 class="accordion-header" id={`heading${index}`}>
                <button
                  class={`accordion-button ${index !== 0 ? 'collapsed' : ''}`}
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target={`#collapse${index}`}
                  aria-expanded={index === 0 ? 'true' : 'false'}
                  aria-controls={`collapse${index}`}
                >
                  {faq.question}
                </button>
              </h3>
              <div
                id={`collapse${index}`}
                class={`accordion-collapse collapse ${index === 0 ? 'show' : ''}`}
                aria-labelledby={`heading${index}`}
                data-bs-parent="#faqAccordion"
              >
                <div class="accordion-body">
                  {faq.answer}
                </div>
              </div>
            </div>
          ))}
        </div>
      </section>
    )}

    <!-- Upcoming Events -->
    {countryData.upcomingEvents && countryData.upcomingEvents.length > 0 && (
      <section class="mb-5">
        <h2 class="mb-4">Upcoming Events</h2>
        <div class="row g-4">
          {countryData.upcomingEvents.map((event) => (
            <div class="col-md-6 col-lg-4">
              <div class="card h-100 shadow-sm">
                <div class="card-header">
                  <span class={`badge ${getEventTypeBadge(event.eventType)}`}>
                    {event.eventType.charAt(0).toUpperCase() + event.eventType.slice(1)}
                  </span>
                  {event.registrationRequired && (
                    <span class="badge bg-secondary ms-2">Registration Required</span>
                  )}
                </div>
                <div class="card-body">
                  <h3 class="card-title h5">{event.name}</h3>
                  <div class="mb-3">
                    <div class="text-muted mb-1">
                      <i class="bi bi-calendar me-2"></i>
                      {formatDateRange(event.date, event.endDate)}
                    </div>
                    <div class="text-muted mb-1">
                      <i class="bi bi-clock me-2"></i>
                      {event.time}
                    </div>
                    <div class="text-muted mb-1">
                      <i class="bi bi-geo-alt me-2"></i>
                      {event.venue}, {event.city}
                    </div>
                  </div>
                  <p class="card-text small">{event.description}</p>
                </div>
              </div>
            </div>
          ))}
        </div>
      </section>
    )}

    <!-- Victories Section -->
    {countryData.victories && countryData.victories.length > 0 && (
      <section class="mb-5">
        <h2 class="mb-4">Our Victories in {countryData.name}</h2>
        <div class="row g-4">
          {countryData.victories.slice(0, 6).map((victory) => (
            <div class="col-md-6">
              <div class="card h-100 shadow-sm border-start border-success border-4">
                <div class="card-body">
                  <div class="d-flex justify-content-between align-items-start mb-2">
                    <span class={`badge ${getCategoryBadge(victory.category)}`}>
                      {victory.category.charAt(0).toUpperCase() + victory.category.slice(1)}
                    </span>
                    <small class="text-muted">{new Date(victory.date).toLocaleDateString('en-US', { month: 'short', year: 'numeric' })}</small>
                  </div>
                  <h3 class="card-title h5">{victory.title}</h3>
                  <p class="card-text small">{victory.description}</p>
                  <div class="mt-3">
                    <strong class="text-success">Impact:</strong>
                    <p class="mb-0 small">{victory.impact}</p>
                  </div>
                  <div class="mt-2">
                    <i class="bi bi-geo-alt me-1 text-muted"></i>
                    <small class="text-muted">{victory.location}</small>
                  </div>
                </div>
              </div>
            </div>
          ))}
        </div>
      </section>
    )}

    <!-- Infrastructure Issues -->
    {countryData.infrastructureIssues && countryData.infrastructureIssues.length > 0 && (
      <section class="mb-5">
        <h2 class="mb-4">Infrastructure Issues We're Addressing</h2>
        <div class="row g-4">
          {countryData.infrastructureIssues.map((issue) => (
            <div class="col-lg-6">
              <div class="card h-100 shadow-sm">
                <div class="card-header">
                  <div class="d-flex justify-content-between align-items-center">
                    <span class={`badge ${getSeverityBadge(issue.severity)}`}>
                      {issue.severity.toUpperCase()}
                    </span>
                    <span class={`badge ${getStatusBadge(issue.status)}`}>
                      {issue.status.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ')}
                    </span>
                  </div>
                </div>
                <div class="card-body">
                  <h3 class="card-title h5">{issue.title}</h3>
                  <p class="card-text">{issue.description}</p>

                  <div class="mt-3">
                    <strong>Affected Areas:</strong>
                    <p class="mb-2">{issue.affectedCities.join(', ')}</p>
                  </div>

                  <div class="alert alert-info mb-2">
                    <strong>Proposed Solution:</strong>
                    <p class="mb-0 small">{issue.proposedSolution}</p>
                  </div>

                  <small class="text-muted">
                    <i class="bi bi-clock me-1"></i>
                    Last updated: {new Date(issue.lastUpdated).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}
                  </small>
                </div>
              </div>
            </div>
          ))}
        </div>
      </section>
    )}

    <!-- Local Statistics -->
    {countryData.localStats && (
      <section class="mb-5">
        <h2 class="mb-4">{countryData.name} Road Safety Data</h2>
        <div class="row g-4">
          <div class="col-md-4">
            <div class="card shadow-sm h-100">
              <div class="card-body text-center">
                <i class="bi bi-exclamation-triangle text-danger fs-1 mb-3"></i>
                <h3 class="h2 mb-2">{countryData.localStats.cyclingFatalities.count}</h3>
                <p class="text-muted mb-2">Cycling Fatalities ({countryData.localStats.cyclingFatalities.year})</p>
                <span class={`badge ${countryData.localStats.cyclingFatalities.change.includes('+') ? 'bg-danger' : 'bg-success'}`}>
                  {countryData.localStats.cyclingFatalities.change}
                </span>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card shadow-sm h-100">
              <div class="card-body">
                <i class="bi bi-signpost-split text-primary fs-1 mb-3 d-block text-center"></i>
                <h3 class="h5 mb-3 text-center">Infrastructure Miles</h3>
                <div class="mb-2">
                  <div class="d-flex justify-content-between">
                    <span>Protected:</span>
                    <strong>{countryData.localStats.infrastructureMiles.protected.toLocaleString()}</strong>
                  </div>
                </div>
                <div class="mb-2">
                  <div class="d-flex justify-content-between">
                    <span>Unprotected:</span>
                    <strong>{countryData.localStats.infrastructureMiles.unprotected.toLocaleString()}</strong>
                  </div>
                </div>
                <div>
                  <div class="d-flex justify-content-between">
                    <span>Planned:</span>
                    <strong>{countryData.localStats.infrastructureMiles.planned.toLocaleString()}</strong>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card shadow-sm h-100">
              <div class="card-body text-center">
                <i class="bi bi-cash-coin text-success fs-1 mb-3"></i>
                <h3 class="h2 mb-2">{formatCurrency(countryData.localStats.fundingSecured.amount, countryData.localStats.fundingSecured.currency)}</h3>
                <p class="text-muted mb-0">Road Funding Secured</p>
                <small class="text-muted">Fiscal Year {countryData.localStats.fundingSecured.year}</small>
              </div>
            </div>
          </div>
        </div>
      </section>
    )}

    <!-- Photo Gallery -->
    {countryData.photoGallery && countryData.photoGallery.length > 0 && (
      <section class="mb-5">
        <h2 class="mb-4">Photo Gallery</h2>
        <div class="row g-3">
          {countryData.photoGallery.map((photo, index) => (
            <div class="col-md-6 col-lg-3">
              <div class="card h-100 shadow-sm">
                <img
                  src={photo.url}
                  alt={photo.alt}
                  class="card-img-top"
                  style="height: 200px; object-fit: cover; cursor: pointer;"
                  data-bs-toggle="modal"
                  data-bs-target={`#photoModal${index}`}
                  loading="lazy"
                />
                <div class="card-body p-2">
                  <p class="card-text small mb-0"><strong>{photo.title}</strong></p>
                  <p class="card-text small text-muted">{photo.caption}</p>
                  <span class={`badge ${photo.category === 'victory' ? 'bg-success' : photo.category === 'event' ? 'bg-primary' : 'bg-secondary'}`}>
                    {photo.category}
                  </span>
                </div>
              </div>

              <!-- Photo Modal -->
              <div class="modal fade" id={`photoModal${index}`} tabindex="-1">
                <div class="modal-dialog modal-lg modal-dialog-centered">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title">{photo.title}</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <img src={photo.url} alt={photo.alt} class="img-fluid" />
                      <p class="mt-3">{photo.caption}</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          ))}
        </div>
      </section>
    )}

    <!-- Join/Contact Section -->
    <section class="mb-5">
      <div class="card shadow-lg">
        <div class="card-body p-5">
          <h2 class="text-center mb-4">Join AARBAA {countryData.name}</h2>
          <p class="text-center mb-4">
            Be part of our growing movement of {countryData.stats.members.toLocaleString()} members across {countryData.stats.chapters} chapters in {countryData.name}. Together, we're advocating for balanced transportation policy and motorists' rights.
          </p>
          <ContactForm prefilledLocation={`${countryData.name} - International`} />
        </div>
      </div>
    </section>

    <!-- Additional Resources -->
    <section class="mb-5">
      <h2 class="mb-4">Additional Resources</h2>
      <div class="row g-3">
        <div class="col-md-4">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <h3 class="h5 card-title">
                <i class="bi bi-newspaper me-2 text-primary"></i>
                News & Updates
              </h3>
              <p class="card-text">Stay informed about our latest advocacy efforts and victories.</p>
              <a href="/news" class="btn btn-sm btn-outline-primary">View All News</a>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <h3 class="h5 card-title">
                <i class="bi bi-flag me-2 text-success"></i>
                US State Chapters
              </h3>
              <p class="card-text">Explore our network of state chapters across the United States.</p>
              <a href="/chapters" class="btn btn-sm btn-outline-success">View State Chapters</a>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <h3 class="h5 card-title">
                <i class="bi bi-globe me-2 text-info"></i>
                Other Countries
              </h3>
              <p class="card-text">See our international presence and advocacy work worldwide.</p>
              <a href="/countries" class="btn btn-sm btn-outline-info">View All Countries</a>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</MainLayout>

<style>
  .stat-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
  }

  .card {
    transition: transform 0.2s ease;
  }

  .card:hover {
    transform: translateY(-2px);
  }

  .accordion-button:not(.collapsed) {
    background-color: #e7f1ff;
    color: #0a58ca;
  }

  .modal-body img {
    max-width: 100%;
    height: auto;
  }
</style>
